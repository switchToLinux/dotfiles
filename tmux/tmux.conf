
#####################################
# å¿«æ·é”®
#è®¾ç½®å‰ç¼€ä¸ºCtrl + a
# set -g prefix C-a
#è§£é™¤Ctrl+b ä¸å‰ç¼€çš„å¯¹åº”å…³ç³»
#unbind C-b

############################################################
##  å¿«æ·é”® ä¸éœ€è¦ä½¿ç”¨ prefix å‰ç¼€
############################################
#X# å¿«æ·é”®(M è¡¨ç¤º Alt )
#X# 
############################################
bind -n M-r source-file ~/.tmux.conf \; display "é‡æ–°åŠ è½½å®Œæˆ!"

bind -n M-q kill-pane  #å…³é—­å½“å‰é¢æ¿(panel)
bind -n M-a display-panes # æ˜¾ç¤ºå½“å‰çª—å£(window)çš„æ‰€æœ‰é¢æ¿(panel)
bind -n M-d detach # è„±ç¦»å½“å‰ä¼šè¯(session)ï¼Œè¿”å›ç»ˆç«¯
bind -n M-w kill-window # Alt+w: å…³é—­å½“å‰çª—å£(window)

bind -n M-\\ run-shell 'option_name="status"; status=$(tmux show -gv ${option_name}); if [[ "$status" == "on" ]]; then new_state=off;  else new_state=on ; fi ;tmux set -g ${option_name} "$new_state";'

# å¿«æ·é”®åˆ—è¡¨æ˜¾ç¤º
bind -n M-/ run-shell "awk -F'bind -n ' '\$0~/^bind -n/{ gsub(\"\#.*\",\"\"); print ; next; }\$0~/^#X# /{print \$0 }' ~/.tmux.conf | sed 's/^bind -n //g;s/M-/Alt+/g;s/C-/Ctrl+/g;' | awk '/^#/{print}/^Alt|^Ctrl/{printf(\"%-15s\", \$1); \$1=\"\"; printf(\"%-100.100s\\n\",\$0); }' |less -R"
bind -n M-\? list-keys

# åˆ‡æ¢é¼ æ ‡çŠ¶æ€(ä½¿ç”¨-gå‚æ•°ï¼Œåœ¨æ‰€æœ‰ä¼šè¯ç”Ÿæ•ˆ)
bind -n M-m run-shell 'option_name="mouse"; status=$(tmux show -gv ${option_name}); if [[ "$status" == "on" ]]; then new_state=off;  else new_state=on ; fi ;tmux set -g ${option_name} "$new_state"; echo "${option_name}çŠ¶æ€: $new_state" '

# Alt+-: åŒæ­¥æ˜¾ç¤ºæ‰€æœ‰é¢æ¿(ä¸ä½¿ç”¨-gå‚æ•°ï¼Œåªåœ¨å½“å‰ä¼šè¯ç”Ÿæ•ˆ)
bind -n M-\- run-shell 'option_name="synchronize-panes"; status=$(tmux show -v ${option_name}); if [[ "$status" == "on" ]]; then new_state=off;  else new_state=on ; fi ;tmux set ${option_name} "$new_state"; echo "${option_name}çŠ¶æ€: $new_state" '


#X# Session ç®¡ç†
#X# 
# é‡å‘½åå½“å‰ä¼šè¯
bind -n M-F2 command-prompt -I "rename-session "

#bind -n F3 choose-tree -Z -F "#{?session_attached,â—‰,â—‹} #{session_name} | çª—å£: #{session_windows} | #{?window_active,â–¶ ,  }#{window_index} #{window_name}"
bind -n F3 choose-tree -Z
# bind -n F3 choose-session -Z -F "#{?session_attached,â—‰,â—‹} #{session_name} | çª—å£: #{session_windows} | #{?window_active,â–¶ ,  }#{window_index} #{window_name}"
bind -n M-` choose-session -Z  # åˆ—å‡ºæ‰€æœ‰sessionä¼šè¯åˆ—è¡¨


#X# --- çª—å£ (Window) ç®¡ç† ---
#X# 
bind -n M-n new-window   #åˆ›å»ºæ–°çª—å£
bind -n F2 command-prompt -I "rename-window "   # é‡å‘½åå½“å‰çª—å£

bind -n M-\[ previous-window  #åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—å£
bind -n M-\] next-window     #åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£

# Alt+1/2/3...0: åˆ‡æ¢åˆ°æŒ‡å®šçª—å£ï¼ˆç´¢å¼•ä»1å¼€å§‹ï¼‰
bind -n M-1 select-window -t :=1
bind -n M-2 select-window -t :=2
bind -n M-3 select-window -t :=3
bind -n M-4 select-window -t :=4
bind -n M-5 select-window -t :=5
bind -n M-6 select-window -t :=6
bind -n M-7 select-window -t :=7
bind -n M-8 select-window -t :=8
bind -n M-9 select-window -t :=9
bind -n M-0 select-window -t :=10
bind -n M-\; command-prompt -I ""

#X# --- é¢æ¿ (Pane) ç®¡ç† ---
#X# 
bind -n M-Enter split-window -h # æ–°å»ºæ¨ªå‘åˆ†å‰²é¢æ¿
bind -n M-v split-window -v  #æ–°å»ºå‚ç›´åˆ†å‰²é¢æ¿

bind -n M-x run-shell "tmux split-window -v; tmux select-layout tiled" # æ–°å»ºå¹³é“ºå¸ƒå±€çš„é¢æ¿(åŠ¨æ€è°ƒæ•´é¢æ¿å¤§å°)
bind -n M-z resize-pane -Z # æœ€å¤§åŒ–å½“å‰é¢æ¿

# Alt+Tab: åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªé¢æ¿
bind -n M-Tab select-window -l
bind -n M-Space select-layout -n


# Alt+h/j/k/l: åœ¨é¢æ¿é—´ç§»åŠ¨ï¼ˆVim é£æ ¼ï¼‰
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R


# Alt+Shift+H/J/K/L: è°ƒæ•´é¢æ¿å¤§å°
bind -n M-H resize-pane -L 5
bind -n M-J resize-pane -D 5
bind -n M-K resize-pane -U 5
bind -n M-L resize-pane -R 5


bind -n M-s break-pane  #å°†å½“å‰é¢æ¿è½¬ä¸ºæ–°çª—å£


############################################
##  é…ç½®ç¯å¢ƒ


set -g default-shell /bin/zsh


# è®¾ç½® pane ç´¢å¼•ä» 1 å¼€å§‹ï¼ˆä¸çª—å£ä¸€è‡´ï¼‰
set -g base-index 1
set-window-option -g pane-base-index 1

#copy-mode å°†å¿«æ·é”®è®¾ç½®ä¸ºvi æ¨¡å¼
set -g mode-keys vi
set -g status-keys vi

# å¯ç”¨é¼ æ ‡æ”¯æŒï¼ˆå¯é€‰ï¼Œæ–¹ä¾¿æ‹–åŠ¨è°ƒæ•´å¤§å°æˆ–é€‰æ‹©ï¼‰
set -g mouse on

# å–æ¶ˆé»˜è®¤çš„é¼ æ ‡æ‹–åŠ¨ç»“æŸç»‘å®š
# copy-mode for emacs
# copy-mode-vi for vi
unbind -Tcopy-mode-vi MouseDragEnd1Pane
# å¯ç”¨é¼ æ ‡é€‰ä¸­æ–‡æœ¬è‡ªåŠ¨å¤åˆ¶
# reference: https://github.com/tmux/tmux/wiki/Getting-Started
# search for "MouseDragEnd1Pane" for more info
if-shell "command -v wl-copy >/dev/null 2>&1" "bind -Tcopy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'wl-copy'"
if-shell "command -v xclip >/dev/null 2>&1" "bind -Tcopy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'xclip -selection clipboard'"
if-shell "command -v pbcopy >/dev/null 2>&1" "bind -Tcopy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'pbcopy'"



# æé«˜å“åº”é€Ÿåº¦
set -sg escape-time 0


#####################################################
# æ’ä»¶ç®¡ç†

# prefix + I(å¤§å†™) : å®‰è£…æ’ä»¶
# prefix + U(å¤§å†™) : æ›´æ–°æ’ä»¶
# prefix + alt + u : æ¸…ç†æ’ä»¶(ä¸åœ¨plugin listä¸­)
# prefix + Ctrl-s - save
# prefix + Ctrl-r - restore

# ä¼šè¯ç®¡ç†æ’ä»¶

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

set -g @continuum-save-interval '15'
set -g @continuum-restore 'on'
set -g @resurrect-capture-pane-contents 'on'
#
# Other config ...

run -b '~/.tmux/plugins/tpm/tpm'

############################################
# ä¸»é¢˜è®¾ç½®
#  å¯ç”¨é¢œè‰²åˆ—è¡¨ï¼š black, red, green, yellow, blue, magenta, cyan, white, brightblack, brightred, brightgreen, brightyellow, brightblue, brightmagenta, brightcyan, brightwhite
#  å¯ç”¨æ ·å¼åˆ—è¡¨ï¼š bold, underline, italic, reverse, blinking, fast-blinking, standout, dim, faint, normal
#  å¯ç”¨èƒŒæ™¯é¢œè‰²åˆ—è¡¨ï¼š default, black, red, green, yellow, blue, magenta, cyan, white, brightblack, brightred, brightgreen, brightyellow, brightblue, brightmagenta, brightcyan, brightwhite
#  å¯ç”¨å‰æ™¯é¢œè‰²åˆ—è¡¨ï¼š default, black, red, green, yellow, blue, magenta, cyan, white, brightblack, brightred, brightgreen, brightyellow, brightblue, brightmagenta, brightcyan, brightwhite
#
############################################



set -g status-interval 1
set -g status-position top
set -g status-style bg=black,fg=white


set -g window-status-format "#[fg=blue,bg=default]#I #F #W"
set -g window-status-current-format "#[fg=white,bold,bg=default]#[fg=red,bg=default]#I #F #W#[fg=white,bg=default]"
set -g window-status-current-style 'underscore'


set -g pane-border-style "fg=white,bold,bg=default"
set -g pane-active-border-style "fg=brightred,bold,bg=default"

help_tips="M+/(Help)"


# çŠ¶æ€æ å·¦ä¾§ä¿¡æ¯

set -g status-left-length 80
set -g status-left "#[fg=cyan,bold,bg=blue][#{help_tips}]"
set -ga status-left "#[fg=brightblack,nobold,bg=magenta,bold] [#S] " # session name

# çŠ¶æ€æ å³ä¾§ä¿¡æ¯
set -g status-right-length 100
set -g status-right "#{pane_title}"
set -ga status-right "#[fg=white,bold,bg=brightred] #{status-keys} "
set -ga status-right "#[fg=green,bold,bg=green][ğŸ–±ï¸ #{?mouse,ON,OFF}]"

set -ga status-right '#[fg=cyan,bold,bg=gray][âŒš %H:%M:%S %A %Y/%m/%d]'

set -ga status-right '#[fg=black,bold,bg=cray] #(uptime -p) '
if-shell "uname | grep -q Linux"  "set -ga status-right '#[fg=black,bold,bg=cyan] #(uname) ğŸ§'"
if-shell "uname | grep -q Darwin" "set -ga status-right '#[fg=black,bold,bg=white] #(uname) îœ‘'"
